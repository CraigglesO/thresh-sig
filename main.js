const { Dealer, Encrypt, VerifyCipherText, DecryptShare, VerifyShare, Convert } = require('./build/Release/addon'); // native c/c++

// const dealer = Dealer(10, 5);

// const dealer = {
//   secret: '607ead9679dc4f4b2a4159c71fc49f138101d043',
//   SKs: [
//    '266ffec15ef567738b67ceb58a445f85be32c262',
//    '68780e442078d804bf70a08a95d5850798bd2a7d',
//    '618a2da5048c472b6caca1f2a3e8506e2b4b013b',
//    '66e83469abc5e9e2472406674cf5e436bc95e395',
//    '68228017112c6bf21096622f60804486bf6712d3',
//    '6f17f4318a36f7f1987aaa5ee512572bd297748d',
//    '1ff5fa3cc6cd2f45bbff34d7183fe39bc10f92aa',
//    '393881bbd14742216609b8466ea592f481c79b63',
//    '13aa00310e6dc7858f374c2893e8effc37c7613e',
//    '2263711e3d79e5413ddc68c66ab8672132265b13',
//   ],
//   VK: '6a270433814ceff56ca5513d06cb5fe4b88aa1a82ccb4bdf215fe54ffe76c0db75c672aa491795ab095ce0e3d4e658a2554386a66b27f70d8315913d51d9ada9776b28ed940b904d7c9556e6ad418d830471645d896463b35403d5654969d8678d681b3e0d283fc04cae70b1ea84f067390345423decbcbca25da96010ac99a0',
//   VKs: [
//    '2587ce6f033bfb13b0493b4e71fd87ea04d49e3cc5cfaeeeb7a70ba649d2bcba6da2b68d41cbe5ff605b078e148bc414a50ac8390da88716793df07bf4b60c563a8235a14adff0e620d59a8e9242a55c96e338e1395508363e2dc09bd5e39104afb4aa852d7dd634e10657ddf6cda19d58595939176e335acc743952a813d95b',
//    '604e650af94157513db8ccdedbe363bfbf2815f79d629b8b03fdc024ff89ed65af4983b39fef52608d2d619cae9196de7f2a34cb5464ad442b7e1782317290f1a47cea7eddadd35e6e31a0114e42005f61aa07f1bf9e116605a0e813c945082fdb0cfed0c75afed8f27c47b956e49125bdd998bee1025c21d599bee0ec1634e1',
//    '39f4e08b6052d33a0b7c109e6c93edde35d4ca916e17de9bdb6ea5de2e1546a708bdc36a13c7402ca72f8ad7c15971530e590c6557fc2d8334b2079df5370def61a3ab500dfdc3a5ab237a5129005889ad83047599c915a7cd8d4440a63b114b884321425a63c405ab07844210031841ee3c824adbd99a5693fb6dd5f7b992b7',
//    '4febf4feed59086f69f18dc3530524a241f200bba7350242b6372e2e62cb08823a52d33f47b201cd43ba76f6140a738cea24fcdb7563fcad4cb7b4c699bf29b177e80ac846f14672e459a4ad9879c6591326b97fde5a2f6ec9212be98028e8a12cf8ce82ae1aae111f912c01946d1a437c93c77bfbdb67e8fac3aba38c7ce7a3',
//    '66810d4700f4f7c5d76461bd2b5f3ed143ef7c3476d7447a19a87979121d2163f4d68f1f32815a4236246175383f2ee4d7fa95b96d9149e2374968da423741d05b3b7777b0fcbfed2d1af4c9494769376a20e163a564ff851b557092b33ef2d8b1e85351385db834bccf8819336ce44b9da44365b02cb337972866074f211572',
//    '76fb801d39b6f9352d1d6c61c72fdd6cf5532f2d2e7e0f6d825cd2ff167d3d23fa106d67ccd3c90a816c8792fc8d11ace9059b321b677cb55257919672818a0b33cdba589394057e6f1630961c62ec5133e5b10d1666e465c469f2e123c806b48fbe4450474094316605424c38d1ba4202eb348292ab127af6b77c2b2742ccd8',
//    'a360e8c880d36bbab6072505a32c99fc0f7b15314d36dbe997e54a123a6d7a328224d9b4de39200c4b76c713f16641f57cb953ad37d430174db54700ca63da0b6100d857bf8e61611dc8b21a5083258bf3dc17babc68c7719cc811b971897f4401ad4dc0c2bf0962ca3b76050e3b6a1f062eb370fa66da5d90c35431c3d59d04',
//    '71488ba0486a3bf29927ab2170fc386b51cb0551ad1e4743d66f5e27c5c5f1240971adc24f38245e7b2ee4867d1211f0486c0fa225c707709a226e6af88890863e9fc041fe8721dd06951bec5bb74f70dc2b397bcf2589dceb44f82866e0ec4d30f7441a3b101bee4aafc52887013bb509977ff62fe945a59700d719a8202929',
//    '137e1b12b78237b7dcd2ffd379132720761a83ad3c3f846c25f64fb4e28636a8678519e5a4d793ece908f6016e3ffc04c7a0b4b70418a9c7577ba80f84f29f1978f3be09be3a26d75e7f4b273e6b1ad026f7eb3e00c991a1f45d4d8bbd666412042061dc2090376d1a53f2e04985e51eb24be688e8efcf3f1d2096dbb8e22e42',
//    '373315412221114069c8ff708c70b694e4505132613a34a9cb2442738aff0b30711d980125ac30a1e595de1309ecb0ff933bc62de09912388a4379b35f5f6c781f7a790647ad2fdd9affedf1669d446e9b02309d7fb0dbfe7aa4ea198ebc577808a5bc51caf76117b67ebd8c49520004ce7ea33be5a55ea86114cc48d0e93691',
//   ]
// };

// console.log("dealer", dealer);
const C = Encrypt("TEST", '3cf0329dd07dca3e078d1424117262fb74b42300cf709ad4b8838124f832339364ff266b691d75a8e460dcd404718ff96975fd282d954c08a8fd72544590efa99bda5a3e8fbb91618610c3f1db66a120fcbb0085e244760bbff8e455e9925ff16c26ed833758ad86c59adfd88a087822a49b3c7cce44c61d681dacbebd0d0f83');
console.log("C", C);

// const C = {
//   U: '213c0cb237dcf23655bfdc806c47d1d019c7e638d7c1c339abcf3cc8b64506c23e421d6493a6e8dfb2f73bd47431153065185c22a147fb2a86bc442e6eed654a77e49b07d00c755c24a06ac41947f681a3c0f2e7eb440e9f446a1bac6fe2b32a8875243776b599618be86a9a7f17b37858a1cb4c813c766742d428c3a7e54f70',
//   V: '7727e0d114b68ea568349ab0e8bd24dc4f8f631ebef276ec5919ea580e0cc377',
//   W: '38635d886b9ab18603c7bf053430cdd4493447b9af4c80880690d3b29256e00c06bb88d7d6b64ab5dea2d1b93e41a1929069299bf3efd092074f044971b79a499a2c1273cfb412deae580260349e29d28f5b6343df945e3978ba81aaca20604ab50e53857b51cc7bc4e994c1a4ac86eed3b85683acf098e225dac6db89cfd9e7'
// };


const verifyCipherText = VerifyCipherText(C);
console.log("Verify", verifyCipherText);
// const shares = dealer.SKs.map((SK) => DecryptShare(C, SK));
// console.log("decrypted shares", shares);
// const VS = VerifyShare(C, '1de3cdef1979aa3b816e161f2a8d9541858f4090bd111398b63e9690794daaa06da41b46dc6971a380dc6f9003e64ec95c9f118b29ebe013249527e198b0d2e6a46cb9b046b9159fa301709faebd240653573a274f73b001f0f814ad96c93b78c6c63e3fe97375656b3eb7f8e3a4d133db7f0b0d4db668d52edcf5edc7818f7e', dealer.VKs[0]);
// const verifiedShares = shares.map((share, i) => VerifyShare(C, share, dealer.VKs[i]));
// console.log("verified Shares", VS);

// let x = Convert('[5720942189307414741205577889045073134773339785030465557053665646568874276977685307291447664384871411023099095811875667689553374148980718629760288273514835, 4517840002995170431139692074561131742896477425256827867617500571076962243525409265018887106595235905752208600961597088447048263883867579691880406559115196]');
// console.log("x", x);

// ************ENCRYPT*************
// r 668446078456621862688939921260498432629873090649
// r 751628a8a33ec3876b321c7bffe42dfc823ca059
// g1 [4264083391895955901265257040028479149400169025615345260303986214726423231173928285256791041998919055277112394516001733341992693480052725918957267301183325, 2116426609166886503385333553365957364401816544109920990955286798122869276384003469957105697651246200288946800075692216092350705727159751274607530017817646]
// g1 516a67cc0efcdaa554a3145c7789be77425c4e96453b4b722585a8d414619a313a7ae6c1a658f55afc5d3561f8ceac67eaab8d19ed4075d9208eab8637f42f5d2868e0b5d34d0c97b3345af78f743499d82b4a2d89709cc372dd20f7b7bbf2d5645991d2663a5df47c3b3838b29f03e730c38b0e02cce2e8551570efea18042e
// U [601816279620196536164092498815696903801325732958570795331667923121081329111451618535049116741184053631628618045766142580205653804274688804190332340027734, 4196204610599590050034065123766745712917622241784991340106208153783516187339265986603357127555826254766375101894705948106472203306461987841783476428615126]
// U 0b7d9ddff92efa11f90ede6794fa0d98ab4b426fbd6b4a2729bbc401ce88acf8ed529583899de95e1dfc4a6e8f1860f465b514012cfa94346c91ee3982ee4156501e9ef25ea6c44d01657b52ff34a67b4ddcf703de4c16adc37d3d9f1bc3c6eb59bcbab4637117a1dc336833224fe70c656e2453690977e10e0085b550fe2dd6
// serialize(g) 4cf49d6f215b49c0b7ce572822f712e83905c3ce6da557fbda53d69c30d6b470b53b5a3b55c2f6993fd34a42ec60c3e71b85fca6c56be1ea76522ae2e5f84e8f01
// serialize(g)
// self.VK ** r [4030488002210709388529616093684889848305089141725956751895604985551034217445778718120495538359646436977514333580539615305376410460424935308952394836496015, 1262734662938600490168250161790896327099174944465067609923282555507071479875350074777170736277064275634179610373628075709108753287895585063318771256673459]
// Self.VK ** r 4cf49d6f215b49c0b7ce572822f712e83905c3ce6da557fbda53d69c30d6b470b53b5a3b55c2f6993fd34a42ec60c3e71b85fca6c56be1ea76522ae2e5f84e8f181c1e53945204363982d9832aaff31016a2f172acf3db5bf006181fdc17e8d5d6ff135e600deefbe918ad438f044a2a2112d493ecde88a8e3ecae28004244b3
// VK [3191596293737117358904926100796341401999813815565615429021844745930950030378529043191015102180645668520942201174306469383340316687545868606637593381105577, 8162680775002750028272512714051789900856302226082183879017376497813012245841380687632130713529136035072262063116440150186673927629377321654608773478420355]
// VK 3cf0329dd07dca3e078d1424117262fb74b42300cf709ad4b8838124f832339364ff266b691d75a8e460dcd404718ff96975fd282d954c08a8fd72544590efa99bda5a3e8fbb91618610c3f1db66a120fcbb0085e244760bbff8e455e9925ff16c26ed833758ad86c59adfd88a087822a49b3c7cce44c61d681dacbebd0d0f83
// hashhh 7cf8dddc6ca18ee2195dc441d1cc3a5ec8b883373c4c1b7aeed92b17df7f921c
// hashhh
// V e816d84f5944090718918fb8d7dfdadf87b82487b78bdd32135f713d29ddbede
// V
// serialize(g) 0x0b 0x7d 0x9d 0xdf 0xf9 0x2e 0xfa 0x11 0xf9 0xe 0xde 0x67 0x94 0xfa 0xd 0x98 0xab 0x4b 0x42 0x6f 0xbd 0x6b 0x4a 0x27 0x29 0xbb 0xc4 0x1 0xce 0x88 0xac 0xf8 0xed 0x52 0x95 0x83 0x89 0x9d 0xe9 0x5e 0x1d 0xfc 0x4a 0x6e 0x8f 0x18 0x60 0xf4 0x65 0xb5 0x14 0x1 0x2c 0xfa 0x94 0x34 0x6c 0x91 0xee 0x39 0x82 0xee 0x41 0x56 0x0
// serialize(g)
// serialize(g) + x 0b7d9ddff92efa11f90ede6794fa0d98ab4b426fbd6b4a2729bbc401ce88acf8ed529583899de95e1dfc4a6e8f1860f465b514012cfa94346c91ee3982ee415600e816d84f5944090718918fb8d7dfdadf87b82487b78bdd32135f713d29ddbede
// serialize(g) + x 0b7d9ddff92efa11f90ede6794fa0d98ab4b426fbd6b4a2729bbc401ce88acf8ed529583899de95e1dfc4a6e8f1860f465b514012cfa94346c91ee3982ee415600e816d84f5944090718918fb8d7dfdadf87b82487b78bdd32135f713d29ddbede
// hashhh2 [7225628476748154583540431206945617314065753169334077212435744727980809523951416523909644305600689405555657406431229467207980530174668433593875980003221214, 7305648813947744913544053363612689629406402257127658525342663885596185772561728021627243389343066091263220106654059486363418823410081843987794941015694898]
// hashhh2 89f622e40f33444b23c4b4ceed78c42a810daebd676a87796c72e43bce242ab9ac672c117a2e838d00fed6901abaddeafd258e86779d7629c627a55c745e9ede8b7d447e5c211c227011659e6b76c08c53df6ebaf5b0f35cee352e84bb225b9aa2b20ce10fa3c8e25b572368cdb4b15701f3fa7f0826fe9709f19f63c3171e32
// W [5720942189307414741205577889045073134773339785030465557053665646568874276977685307291447664384871411023099095811875667689553374148980718629760288273514835, 4517840002995170431139692074561131742896477425256827867617500571076962243525409265018887106595235905752208600961597088447048263883867579691880406559115196]
// W 6d3b620751309b776a8f54200ca611af7c73bb523a55407dfbd096b5935ce6d825cb4a7ae0ddb2e8e50c793649dc1c1ade5b5c2da6957b1b89708a773f28c1535642bdef7a69c0195c93527e7ded83b7b75d5d77ea60d2478eb9bbe2f345fcda024382b3eb84618a103e13db641730a48c7763b7e2f3dfc427e33d9b9e0e47bc
// ************ENCRYPT*************

// [ ] Dealer
// [ ] Encrypt
// [ ] Verify Encrypt
// [x] Decrypt Share
// [ ] Verify Share
